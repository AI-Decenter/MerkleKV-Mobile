# Access Control List for Integration Testing
# Defines topic-level permissions for different clients

# =============================================================================
# Client Certificate Based Access (CN=test-client)
# =============================================================================

# Full access for primary test client
user test-client
topic readwrite merkle_kv/+/+
topic readwrite merkle_kv/+/+/+
topic readwrite $SYS/#

# =============================================================================
# Client Certificate Based Access (CN=test-client-2)
# =============================================================================

# Limited access for secondary test client (for ACL testing)
user test-client-2
topic readwrite merkle_kv/node2/+
topic readwrite merkle_kv/node2/+/+
topic read $SYS/broker/uptime

# =============================================================================
# Username/Password Based Access
# =============================================================================

# Admin user for setup operations
user admin
topic readwrite #

# Test user with limited access
user testuser
topic readwrite merkle_kv/testnode/+
topic readwrite merkle_kv/testnode/+/+

# Restricted user for ACL violation testing
user restricted
topic read merkle_kv/public/+

# =============================================================================
# Pattern Based Access Control
# =============================================================================

# Pattern for node-specific access
pattern readwrite merkle_kv/%c/+
pattern readwrite merkle_kv/%c/+/+

# =============================================================================
# Anonymous Access (when enabled)
# =============================================================================

# Limited anonymous access for basic connectivity tests
topic read $SYS/broker/uptime
topic read $SYS/broker/version